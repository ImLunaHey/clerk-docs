---
title: Requiring Authorization for Route protection | Next.js
description: Learn how to protect the B2B (Business to Business) routes in your Next.js application that require authorization.
---

# Required Authorization for Route protection 

Whether you're in the App Router, Pages Router, or Middleware, Clerk provides access to a standardized [Auth](/docs/references/nextjs/authentication-object) object that you can use to require authentication throughout your application. Below, we explain how to access and use the Auth object.

If you want to learn about protecting routes based on [organization](/docs/organizations/overview) roles or permissions, see the [requiring authentication](/docs/references/nextjs/route-protection-requiring-authentication) guide.


## App Router

### Protect a layout or page

You can use `protect()` and `has()` in a route's `layout.tsx` to protect based on roles or permissions.

<CodeBlockTabs type="router" options={["protect()", "has()"]}>

```tsx filename="app/dashboard/manage-users/layout.tsx" 
import { auth } from "@clerk/nextjs/server";

export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  auth().protect({ permission: "org:test:permission" })
  return (
    <div>{children}</div>
  )
}
```

```tsx filename="app/dashboard/manage-users/layout.tsx" 
import { auth } from '@clerk/nextjs/server'
import { redirect } from 'next/navigation'

export default async function Layout({ children }: { children: React.ReactNode }) {
  if (!auth().has({ role: "org:admin" })) {
    redirect("/")
  }
  return <>{children}</>
}
```
</CodeBlockTabs>


You can use `protect()` and `has()` in a specific page to protect using roles and permissions from organizations.

<CodeBlockTabs type="router" options={["protect()", "has()"]}>
```tsx filename="app/manage-users/page.tsx"
import { auth } from "@clerk/nextjs/server"

export default function Page() {

  auth().protect({ permission: "org:test:permission" })

  return (
    <p>This is a page</p>
  )
}
```

```tsx filename="app/dashboard/manage-users/page.tsx" 
import { auth } from '@clerk/nextjs/server'

export default function Page() {

if (!auth().has({ role: "org:admin" })) {
    return <p>You do not have permission to view this page.</p>
  }

  return (
    <>
      <h1>Manage Users</h1>
      <p>Manage your users, invite new users or ban users</p>
    </>
  );
}
```
</CodeBlockTabs>

### Protect your Route Handlers and Server Actions

asdfs


## Pages Router

### Protect a page
sadff

### Protect your application with `_app.tsx`

assda

## Protect your application with Middleware

You can manage your route protection with `clerkMiddleware()` along with `has()` and `protect()` to protect based on organization roles and permissions.

```tsx filename="middleware.tsx"
import {
  clerkMiddleware,
  createRouteMatcher,
} from '@clerk/nextjs/server';

const isProtectedRoute = createRouteMatcher([
  '/dashboard'
]);

export default clerkMiddleware((auth, req) => {
  // Restricted to logged in users
  // Logged out users will be redirected to sign-in route
  if (isProtectedRoute(req)) {
    console.log('test', auth().protect())
    auth().protect()
  }
}

export const config = {
  matcher: ['/((?!.*\\..*|_next).*)', '/', '/(api|trpc)(.*)'],
};
```


